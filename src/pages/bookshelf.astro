---
import BaseLayout from '../layouts/BaseLayout.astro';

interface Book {
  title: string;
  author: string;
  cover: string;
  amazonUrl: string;
}

interface Category {
  name: string;
  books: Book[];
}

// Helper to generate Amazon search URL
const amazonSearch = (title: string, author: string) =>
  `https://www.amazon.com/s?k=${encodeURIComponent(title + ' ' + author + ' book')}`;

// Helper to generate cover filename
const coverFile = (title: string) =>
  `/images/books/${title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/-+/g, '-').replace(/^-|-$/g, '')}.jpg`;

const categories: Category[] = [
  {
    name: "Product Management & Strategy",
    books: [
      { title: "Inspired", author: "Marty Cagan", cover: coverFile("Inspired"), amazonUrl: amazonSearch("Inspired", "Marty Cagan") },
      { title: "Empowered", author: "Marty Cagan", cover: coverFile("Empowered"), amazonUrl: amazonSearch("Empowered", "Marty Cagan") },
      { title: "Continuous Discovery Habits", author: "Teresa Torres", cover: coverFile("Continuous Discovery Habits"), amazonUrl: amazonSearch("Continuous Discovery Habits", "Teresa Torres") },
      { title: "Escaping the Build Trap", author: "Melissa Perri", cover: coverFile("Escaping the Build Trap"), amazonUrl: amazonSearch("Escaping the Build Trap", "Melissa Perri") },
      { title: "Working Backwards", author: "Colin Bryar & Bill Carr", cover: coverFile("Working Backwards"), amazonUrl: amazonSearch("Working Backwards", "Colin Bryar") },
      { title: "User Story Mapping", author: "Jeff Patton", cover: coverFile("User Story Mapping"), amazonUrl: amazonSearch("User Story Mapping", "Jeff Patton") },
      { title: "Competing Against Luck", author: "Clayton Christensen", cover: coverFile("Competing Against Luck"), amazonUrl: amazonSearch("Competing Against Luck", "Clayton Christensen") },
      { title: "Hooked", author: "Nir Eyal", cover: coverFile("Hooked"), amazonUrl: amazonSearch("Hooked", "Nir Eyal") },
      { title: "Obviously Awesome", author: "April Dunford", cover: coverFile("Obviously Awesome"), amazonUrl: amazonSearch("Obviously Awesome", "April Dunford") },
      { title: "Product Roadmaps Relaunched", author: "C. Todd Lombardo", cover: coverFile("Product Roadmaps Relaunched"), amazonUrl: amazonSearch("Product Roadmaps Relaunched", "C. Todd Lombardo") },
      { title: "Zero to One", author: "Peter Thiel", cover: coverFile("Zero to One"), amazonUrl: amazonSearch("Zero to One", "Peter Thiel") },
      { title: "Traction", author: "Gabriel Weinberg", cover: coverFile("Traction"), amazonUrl: amazonSearch("Traction", "Gabriel Weinberg") },
      { title: "The Lean Startup", author: "Eric Ries", cover: coverFile("The Lean Startup"), amazonUrl: amazonSearch("The Lean Startup", "Eric Ries") },
      { title: "Sprint", author: "Jake Knapp", cover: coverFile("Sprint"), amazonUrl: amazonSearch("Sprint", "Jake Knapp") },
      { title: "The Innovator's Dilemma", author: "Clayton Christensen", cover: coverFile("The Innovators Dilemma"), amazonUrl: amazonSearch("The Innovator's Dilemma", "Clayton Christensen") },
      { title: "Loved", author: "Martina Lauchengco", cover: coverFile("Loved"), amazonUrl: amazonSearch("Loved", "Martina Lauchengco") },
      { title: "Transformed", author: "Marty Cagan", cover: coverFile("Transformed"), amazonUrl: amazonSearch("Transformed", "Marty Cagan") },
      { title: "Sense and Respond", author: "Jeff Gothelf", cover: coverFile("Sense and Respond"), amazonUrl: amazonSearch("Sense and Respond", "Jeff Gothelf") },
      { title: "Product-Led Growth", author: "Wes Bush", cover: coverFile("Product-Led Growth"), amazonUrl: amazonSearch("Product-Led Growth", "Wes Bush") }
    ]
  },
  {
    name: "Leadership & Organizations",
    books: [
      { title: "Good to Great", author: "Jim Collins", cover: coverFile("Good to Great"), amazonUrl: amazonSearch("Good to Great", "Jim Collins") },
      { title: "Great by Choice", author: "Jim Collins", cover: coverFile("Great by Choice"), amazonUrl: amazonSearch("Great by Choice", "Jim Collins") },
      { title: "Good Strategy/Bad Strategy", author: "Richard Rumelt", cover: coverFile("Good Strategy Bad Strategy"), amazonUrl: amazonSearch("Good Strategy Bad Strategy", "Richard Rumelt") },
      { title: "The Hard Thing About Hard Things", author: "Ben Horowitz", cover: coverFile("The Hard Thing About Hard Things"), amazonUrl: amazonSearch("The Hard Thing About Hard Things", "Ben Horowitz") },
      { title: "High Output Management", author: "Andy Grove", cover: coverFile("High Output Management"), amazonUrl: amazonSearch("High Output Management", "Andy Grove") },
      { title: "Team Topologies", author: "Matthew Skelton & Manuel Pais", cover: coverFile("Team Topologies"), amazonUrl: amazonSearch("Team Topologies", "Matthew Skelton") },
      { title: "The Five Dysfunctions of a Team", author: "Patrick Lencioni", cover: coverFile("The Five Dysfunctions of a Team"), amazonUrl: amazonSearch("The Five Dysfunctions of a Team", "Patrick Lencioni") },
      { title: "An Elegant Puzzle", author: "Will Larson", cover: coverFile("An Elegant Puzzle"), amazonUrl: amazonSearch("An Elegant Puzzle", "Will Larson") },
      { title: "Dare to Lead", author: "Bren√© Brown", cover: coverFile("Dare to Lead"), amazonUrl: amazonSearch("Dare to Lead", "Brene Brown") },
      { title: "Extreme Ownership", author: "Jocko Willink", cover: coverFile("Extreme Ownership"), amazonUrl: amazonSearch("Extreme Ownership", "Jocko Willink") },
      { title: "The Dichotomy of Leadership", author: "Jocko Willink", cover: coverFile("The Dichotomy of Leadership"), amazonUrl: amazonSearch("The Dichotomy of Leadership", "Jocko Willink") },
      { title: "No Rules Rules", author: "Reed Hastings", cover: coverFile("No Rules Rules"), amazonUrl: amazonSearch("No Rules Rules", "Reed Hastings") },
      { title: "Culture Code", author: "Daniel Coyle", cover: coverFile("Culture Code"), amazonUrl: amazonSearch("The Culture Code", "Daniel Coyle") },
      { title: "The Outsiders", author: "William Thorndike", cover: coverFile("The Outsiders"), amazonUrl: amazonSearch("The Outsiders", "William Thorndike") },
      { title: "Brave New Work", author: "Aaron Dignan", cover: coverFile("Brave New Work"), amazonUrl: amazonSearch("Brave New Work", "Aaron Dignan") },
      { title: "Build", author: "Tony Fadell", cover: coverFile("Build"), amazonUrl: amazonSearch("Build", "Tony Fadell") },
      { title: "Scale", author: "Reid Hoffman", cover: coverFile("Scale"), amazonUrl: amazonSearch("Masters of Scale", "Reid Hoffman") },
      { title: "Leadership in Turbulent Times", author: "Doris Kearns Goodwin", cover: coverFile("Leadership in Turbulent Times"), amazonUrl: amazonSearch("Leadership in Turbulent Times", "Doris Kearns Goodwin") }
    ]
  },
  {
    name: "Thinking & Decision Making",
    books: [
      { title: "Thinking in Bets", author: "Annie Duke", cover: coverFile("Thinking in Bets"), amazonUrl: amazonSearch("Thinking in Bets", "Annie Duke") },
      { title: "Range", author: "David Epstein", cover: coverFile("Range"), amazonUrl: amazonSearch("Range", "David Epstein") },
      { title: "The Scout Mindset", author: "Julia Galef", cover: coverFile("The Scout Mindset"), amazonUrl: amazonSearch("The Scout Mindset", "Julia Galef") },
      { title: "Superforecasting", author: "Philip Tetlock", cover: coverFile("Superforecasting"), amazonUrl: amazonSearch("Superforecasting", "Philip Tetlock") },
      { title: "Tools of Titans", author: "Tim Ferriss", cover: coverFile("Tools of Titans"), amazonUrl: amazonSearch("Tools of Titans", "Tim Ferriss") }
    ]
  },
  {
    name: "Design & Innovation",
    books: [
      { title: "Change by Design", author: "Tim Brown", cover: coverFile("Change by Design"), amazonUrl: amazonSearch("Change by Design", "Tim Brown") },
      { title: "The Design of Everyday Things", author: "Don Norman", cover: coverFile("The Design of Everyday Things"), amazonUrl: amazonSearch("The Design of Everyday Things", "Don Norman") },
      { title: "Design Org Design", author: "Peter Merholz", cover: coverFile("Org Design for Design Orgs"), amazonUrl: amazonSearch("Org Design for Design Orgs", "Peter Merholz") },
      { title: "Solving Problems with Design Thinking", author: "Jeanne Liedtka", cover: coverFile("Solving Problems with Design Thinking"), amazonUrl: amazonSearch("Solving Problems with Design Thinking", "Jeanne Liedtka") }
    ]
  },
  {
    name: "Communication & Sales",
    books: [
      { title: "Never Split the Difference", author: "Chris Voss", cover: coverFile("Never Split the Difference"), amazonUrl: amazonSearch("Never Split the Difference", "Chris Voss") },
      { title: "Getting to Yes", author: "Roger Fisher", cover: coverFile("Getting to Yes"), amazonUrl: amazonSearch("Getting to Yes", "Roger Fisher") },
      { title: "Nonviolent Communication", author: "Marshall Rosenberg", cover: coverFile("Nonviolent Communication"), amazonUrl: amazonSearch("Nonviolent Communication", "Marshall Rosenberg") },
      { title: "The Challenger Sale", author: "Matthew Dixon", cover: coverFile("The Challenger Sale"), amazonUrl: amazonSearch("The Challenger Sale", "Matthew Dixon") },
      { title: "Predictable Revenue", author: "Aaron Ross", cover: coverFile("Predictable Revenue"), amazonUrl: amazonSearch("Predictable Revenue", "Aaron Ross") },
      { title: "Give and Take", author: "Adam Grant", cover: coverFile("Give and Take"), amazonUrl: amazonSearch("Give and Take", "Adam Grant") }
    ]
  },
  {
    name: "Technology & Business",
    books: [
      { title: "Platform Revolution", author: "Geoffrey Parker", cover: coverFile("Platform Revolution"), amazonUrl: amazonSearch("Platform Revolution", "Geoffrey Parker") },
      { title: "The Third Wave", author: "Steve Case", cover: coverFile("The Third Wave"), amazonUrl: amazonSearch("The Third Wave", "Steve Case") },
      { title: "Power and Prediction", author: "Ajay Agrawal", cover: coverFile("Power and Prediction"), amazonUrl: amazonSearch("Power and Prediction", "Ajay Agrawal") },
      { title: "Rework", author: "Jason Fried", cover: coverFile("Rework"), amazonUrl: amazonSearch("Rework", "Jason Fried") },
      { title: "Let My People Go Surfing", author: "Yvon Chouinard", cover: coverFile("Let My People Go Surfing"), amazonUrl: amazonSearch("Let My People Go Surfing", "Yvon Chouinard") }
    ]
  }
];
---

<BaseLayout title="Bookshelf" description="Books that have shaped Brandon Keao's thinking on product, strategy, leadership, and decision-making.">
  <section class="py-16 md:py-24">
    <div class="container">
      <div class="max-w-5xl">
        <h1 class="mb-4">Bookshelf</h1>
        <p class="lead mb-8">Books that shaped how I think about building products and leading teams.</p>

        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">
          {categories.flatMap(category => category.books).map(book => (
            <a
              href={book.amazonUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="group block"
            >
              <div class="aspect-[2/3] overflow-hidden border border-[var(--border)] group-hover:border-[var(--accent)] transition-colors bg-[var(--bg-secondary)]">
                <img
                  src={book.cover}
                  alt={book.title}
                  class="w-full h-full object-cover"
                  loading="lazy"
                  onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
                />
                <div class="hidden w-full h-full items-center justify-center p-4 text-center">
                  <span class="text-xs text-[var(--text-tertiary)] font-medium leading-tight">{book.title}</span>
                </div>
              </div>
              <p class="mt-2 text-[11px] font-sans font-normal leading-tight group-hover:text-[var(--accent)] transition-colors">{book.title}</p>
              <p class="text-[10px] font-sans text-[var(--text-tertiary)] mt-0.5">{book.author}</p>
            </a>
          ))}
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
